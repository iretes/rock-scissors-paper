<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Computational Models for Complex System – ecological_models_summary</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Computational Models for Complex System</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-site-map" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Site Map</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-site-map">    
        <li>
    <a class="dropdown-item" href="./notebooks/long_range_simulations.html" rel="" target="">
 <span class="dropdown-text">Analysis of long-range ecological models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./notebooks/lattice_simulations.html" rel="" target="">
 <span class="dropdown-text">Analysis of ecological lattice models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./notebooks/repressilator.html" rel="" target="">
 <span class="dropdown-text">Analysis of the Repressilator model</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/iretes/rock-scissors-paper" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ecological-models-summary" id="toc-ecological-models-summary" class="nav-link active" data-scroll-target="#ecological-models-summary">Ecological Models Summary</a>
  <ul class="collapse">
  <li><a href="#long-range-models" id="toc-long-range-models" class="nav-link" data-scroll-target="#long-range-models">Long range models</a></li>
  <li><a href="#lattice-models" id="toc-lattice-models" class="nav-link" data-scroll-target="#lattice-models">Lattice models</a></li>
  <li><a href="#long-range-model-simulations" id="toc-long-range-model-simulations" class="nav-link" data-scroll-target="#long-range-model-simulations">Long range model simulations</a></li>
  <li><a href="#lattice-model-simulations" id="toc-lattice-model-simulations" class="nav-link" data-scroll-target="#lattice-model-simulations">Lattice model simulations</a></li>
  <li><a href="#additional-experiments" id="toc-additional-experiments" class="nav-link" data-scroll-target="#additional-experiments">Additional Experiments</a></li>
  <li><a href="#stochastic-model-checking" id="toc-stochastic-model-checking" class="nav-link" data-scroll-target="#stochastic-model-checking">Stochastic Model Checking</a></li>
  <li><a href="#petri-net-analysis" id="toc-petri-net-analysis" class="nav-link" data-scroll-target="#petri-net-analysis">Petri Net Analysis</a>
  <ul class="collapse">
  <li><a href="#p--t-invariants-and-siphons" id="toc-p--t-invariants-and-siphons" class="nav-link" data-scroll-target="#p--t-invariants-and-siphons">P-, T-invariants and Siphons</a></li>
  <li><a href="#properties" id="toc-properties" class="nav-link" data-scroll-target="#properties">Properties</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="ecological-models-summary" class="level1">
<h1>Ecological Models Summary</h1>
<section id="long-range-models" class="level2">
<h2 class="anchored" data-anchor-id="long-range-models">Long range models</h2>
<table class="table">
<colgroup>
<col style="width: 35%">
<col style="width: 65%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Discrete time</td>
<td>There are <span class="math inline">\(N\)</span> individuals, two individuals are chosen at each time-step and the occupant of the first replicates into the second according to its invasion rate.</td>
</tr>
<tr class="even">
<td>Continuous time</td>
<td><span class="math inline">\(\begin{cases}\frac{\partial n_r}{\partial t}=n_r\cdot (n_s\cdot P_r - n_p \cdot P_p)\\ \frac{\partial n_s}{\partial t}=n_s\cdot (n_p\cdot P_s - n_r \cdot P_r)\\ \frac{\partial n_p}{\partial t}=n_p\cdot (n_r\cdot P_p - n_s \cdot P_s)\\ \end{cases}\)</span></td>
</tr>
<tr class="odd">
<td>Discrete time <br>(mean field recurrence relations)</td>
<td><span class="math inline">\(\begin{cases} n_r[t+\Delta_t]=n_r[t] + \Delta_t \cdot n_r[t](n_s[t]P_r - n_p[t] P_p)\\ n_s[t+\Delta_t]=n_s[t] + \Delta_t \cdot n_s[t](n_p[t]P_s - n_r[t] P_r)\\ n_p[t+\Delta_t]=n_p[t] + \Delta_t \cdot n_p[t](n_r[t]P_p - n_s[t] P_s)\\ \end{cases}\)</span></td>
</tr>
<tr class="even">
<td>Chemical reactions</td>
<td><span class="math inline">\(\begin{cases} R + S \xrightarrow{P_r} 2R\\ S + P \xrightarrow{P_s} 2S\\ P + R \xrightarrow{P_p} 2P\\ \end{cases}\)</span></td>
</tr>
<tr class="odd">
<td>PRISM CTMC</td>
<td></td>
</tr>
<tr class="even">
<td>Petri Net</td>
<td><img width="150" src="./results/petri_net.png"></td>
</tr>
</tbody>
</table>
</section>
<section id="lattice-models" class="level2">
<h2 class="anchored" data-anchor-id="lattice-models">Lattice models</h2>
<table class="table">
<colgroup>
<col style="width: 35%">
<col style="width: 65%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Frean and Abraham</td>
<td>The <span class="math inline">\(N\)</span> sites are taken to be sites in a periodic, rectangular lattice and each agent is activated once per time-step, in random order. During each activation, an agent competes with a randomly chosen neighboring agent. If the neighboring agent can be defeated, the agent wins the competition with a probability determined by the invasion rate. If the agent wins the competition, the neighboring agent is transformed into an individual of the same species of the winning agent.</td>
</tr>
<tr class="even">
<td>Simultaneous activations</td>
<td>The <span class="math inline">\(N\)</span> sites are again taken to be sites in a periodic, rectangular lattice, but at each time step, all agents are activated simultaneously. During each activation, each agent competes with all its neighboring agents. In a three species system, if an agent is surrounded by at least three neighbors of a species that defeats it, the agent is converted into an individual of that species. Please note that invasion rates are not used in this model.</td>
</tr>
<tr class="odd">
<td>Reichenbach, Mobilia and Frey model</td>
<td>In this model the <span class="math inline">\(N\)</span> sites are taken to be sites in a periodic, rectangular lattice. Each patch can be occupied by one of the species or can be blank. Each tick, the following types of events happen at defined average rates: 1) <strong>Select event</strong>: Two random neighbors compete with each other; the losing patch becomes blank. 2) <strong>Reproduce event</strong>: Two random neighbors attempt to reproduce; if one of the neighbors is blank, it acquires the color of the other; nothing happens if neither neighbor is blank. 3) <strong>Swap event</strong>: Two random neighbors swap color; this event represents the organisms moving on the lattice.</td>
</tr>
</tbody>
</table>
</section>
<section id="long-range-model-simulations" class="level2">
<h2 class="anchored" data-anchor-id="long-range-model-simulations">Long range model simulations</h2>
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 32%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Parameters</th>
<th>Species evolution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Discrete time</td>
<td><span class="math inline">\(N=1000\)</span><br><span class="math inline">\(P_r=0.2\)</span><br><span class="math inline">\(P_s=0.5\)</span><br><span class="math inline">\(P_p=0.3\)</span><br><span class="math inline">\(n_r^0=0.5\)</span><br><span class="math inline">\(n_s^0=0.3\)</span><br><span class="math inline">\(n_p^0=0.2\)</span></td>
<td><img width="600" src="./results/discrete1_evolution.png"></td>
</tr>
<tr class="even">
<td>Discrete time</td>
<td><span class="math inline">\(N=1000\)</span><br><span class="math inline">\(P_r=0.2\)</span><br><span class="math inline">\(P_s=0.5\)</span><br><span class="math inline">\(P_p=0.3\)</span><br><span class="math inline">\(n_r^0=0.33\)</span><br><span class="math inline">\(n_s^0=0.33\)</span><br><span class="math inline">\(n_p^0=0.33\)</span></td>
<td><img width="600" src="./results/discrete2_evolution.png"></td>
</tr>
<tr class="odd">
<td>Continuous time</td>
<td><span class="math inline">\(N=\infty\)</span><br><span class="math inline">\(P_r=0.2\)</span><br><span class="math inline">\(P_s=0.5\)</span><br><span class="math inline">\(P_p=0.3\)</span><br><span class="math inline">\(n_r^0=0.5\)</span><br><span class="math inline">\(n_s^0=0.3\)</span><br><span class="math inline">\(n_p^0=0.2\)</span></td>
<td><img width="600" src="./results/continuous1_evolution.png"></td>
</tr>
<tr class="even">
<td>Continuous time</td>
<td><span class="math inline">\(N=\infty\)</span><br><span class="math inline">\(P_r=0.2\)</span><br><span class="math inline">\(P_s=0.5\)</span><br><span class="math inline">\(P_p=0.3\)</span><br><span class="math inline">\(n_r^0=0.33\)</span><br><span class="math inline">\(n_s^0=0.33\)</span><br><span class="math inline">\(n_p^0=0.33\)</span></td>
<td><img width="600" src="./results/continuous2_evolution.png"></td>
</tr>
<tr class="odd">
<td>Discrete time <br>(mean field recurrence relations)</td>
<td><span class="math inline">\(N=\infty\)</span><br><span class="math inline">\(P_r=0.2\)</span><br><span class="math inline">\(P_s=0.5\)</span><br><span class="math inline">\(P_p=0.3\)</span><br><span class="math inline">\(n_r^0=0.33\)</span><br><span class="math inline">\(n_s^0=0.33\)</span><br><span class="math inline">\(n_p^0=0.33\)</span><br><span class="math inline">\(\Delta_t=1\)</span></td>
<td><img width="600" src="./results/recrel1_evolution.png"></td>
</tr>
<tr class="even">
<td>Discrete time <br>(mean field recurrence relations)</td>
<td><span class="math inline">\(N=\infty\)</span><br><span class="math inline">\(P_r=0.2\)</span><br><span class="math inline">\(P_s=0.5\)</span><br><span class="math inline">\(P_p=0.3\)</span><br><span class="math inline">\(n_r^0=0.33\)</span><br><span class="math inline">\(n_s^0=0.33\)</span><br><span class="math inline">\(n_p^0=0.33\)</span><br><span class="math inline">\(\Delta_t=0.01\)</span></td>
<td><img width="600" src="./results/recrel2_evolution.png"></td>
</tr>
<tr class="odd">
<td>Stochastic simulation <br>of chemical reaction</td>
<td><span class="math inline">\(P_r=0.2\)</span><br><span class="math inline">\(P_s=0.5\)</span><br><span class="math inline">\(P_p=0.3\)</span><br><span class="math inline">\(R=50000\)</span><br><span class="math inline">\(S=30000\)</span><br><span class="math inline">\(P=20000\)</span></td>
<td><img width="350" src="./results/stochastic1_evolution.png"></td>
</tr>
<tr class="even">
<td>Stochastic simulation <br>of chemical reaction</td>
<td><span class="math inline">\(P_r=0.2\)</span><br><span class="math inline">\(P_s=0.5\)</span><br><span class="math inline">\(P_p=0.3\)</span><br><span class="math inline">\(R=50\)</span><br><span class="math inline">\(S=30\)</span><br><span class="math inline">\(P=20\)</span></td>
<td><img width="350" src="./results/stochastic2_evolution.png"></td>
</tr>
<tr class="odd">
<td>Stochastic simulation <br>of chemical reaction</td>
<td><span class="math inline">\(P_r=0.2\)</span><br><span class="math inline">\(P_s=0.5\)</span><br><span class="math inline">\(P_p=0.3\)</span><br><span class="math inline">\(R=33\)</span><br><span class="math inline">\(S=33\)</span><br><span class="math inline">\(P=33\)</span></td>
<td><img width="350" src="./results/stochastic3_evolution.png"></td>
</tr>
</tbody>
</table>
</section>
<section id="lattice-model-simulations" class="level2">
<h2 class="anchored" data-anchor-id="lattice-model-simulations">Lattice model simulations</h2>
<p>Rules:</p>
<ul>
<li>with <span class="math inline">\(3\)</span> species: <span class="math inline">\(r&gt;s\)</span>; <span class="math inline">\(s&gt;p\)</span>; <span class="math inline">\(p&gt;r\)</span></li>
<li>with <span class="math inline">\(4\)</span> species: <span class="math inline">\(r&gt;s\)</span>; <span class="math inline">\(s&gt;p\)</span>; <span class="math inline">\(p&gt;u\)</span>; <span class="math inline">\(u&gt;r\)</span>; <span class="math inline">\((r,p)\)</span> and <span class="math inline">\((s,u)\)</span> do not compete</li>
<li>with <span class="math inline">\(5\)</span> species: <span class="math inline">\(r&gt;s,p\)</span>; <span class="math inline">\(s&gt;p,u\)</span>; <span class="math inline">\(p&gt;u,v\)</span>; <span class="math inline">\(u&gt;v,r\)</span>; <span class="math inline">\(v&gt;r,s\)</span></li>
</ul>
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 24%">
<col style="width: 22%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Parameters</th>
<th style="text-align: center;">Animation</th>
<th>Species evolution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Frean and Abraham</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=200\cdot 200\)</span><br><span class="math inline">\(P_r=0.33\)</span><br><span class="math inline">\(P_s=0.33\)</span><br><span class="math inline">\(P_p=0.33\)</span><br><span class="math inline">\(n_r^0=0.33\)</span><br><span class="math inline">\(n_s^0=0.33\)</span><br><span class="math inline">\(n_p^0=0.33\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(100\)</span><br> <img width="300" src="./results/lattice2_animation.gif"></td>
<td><img width="400" src="./results/lattice2_evolution.png"></td>
</tr>
<tr class="even">
<td>Frean and Abraham</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=200\cdot 200\)</span><br><span class="math inline">\(P_r=0.1\)</span><br><span class="math inline">\(P_s=0.1\)</span><br><span class="math inline">\(P_p=0.8\)</span><br><span class="math inline">\(n_r^0=0.1\)</span><br><span class="math inline">\(n_s^0=0.8\)</span><br><span class="math inline">\(n_p^0=0.1\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(100\)</span><br> <img width="300" src="./results/lattice3_animation.gif"></td>
<td><img width="400" src="./results/lattice3_evolution.png"></td>
</tr>
<tr class="odd">
<td>Frean and Abraham</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=200\cdot 200\)</span><br><span class="math inline">\(P_r=0.05\)</span><br><span class="math inline">\(P_s=0.475\)</span><br><span class="math inline">\(P_p=0.475\)</span><br><span class="math inline">\(n_r^0=0.475\)</span><br><span class="math inline">\(n_s^0=0.475\)</span><br><span class="math inline">\(n_p^0=0.05\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(100\)</span><br> <img width="300" src="./results/lattice4_animation.gif"></td>
<td><img width="400" src="./results/lattice4_evolution.png"></td>
</tr>
<tr class="even">
<td>Frean and Abraham</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=200\cdot 200\)</span><br><span class="math inline">\(P_r=0.05\)</span><br><span class="math inline">\(P_s=0.5\)</span><br><span class="math inline">\(P_p=0.3\)</span><br><span class="math inline">\(n_r^0=0.5\)</span><br><span class="math inline">\(n_s^0=0.3\)</span><br><span class="math inline">\(n_p^0=0.05\)</span><br><span class="math inline">\(increase\_r\_rate=\texttt{True}\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(100\)</span><br> <img width="300" src="./results/lattice5_animation.gif"></td>
<td><img width="400" src="./results/lattice5_evolution.png"></td>
</tr>
<tr class="odd">
<td>Simultaneous activations</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=200\cdot 200\)</span><br><span class="math inline">\(n_r^0=0.33\)</span><br><span class="math inline">\(n_s^0=0.33\)</span><br><span class="math inline">\(n_p^0=0.33\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(200\)</span><br> <img width="300" src="./results/lattice6_animation.gif"></td>
<td><img width="400" src="./results/lattice6_evolution.png"></td>
</tr>
<tr class="even">
<td>Simultaneous activations</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=200\cdot 200\)</span><br><span class="math inline">\(n_r^0=0.2\)</span><br><span class="math inline">\(n_s^0=0.4\)</span><br><span class="math inline">\(n_p^0=0.4\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(400\)</span><br> <img width="300" src="./results/lattice7_animation.gif"></td>
<td><img width="400" src="./results/lattice7_evolution.png"></td>
</tr>
<tr class="odd">
<td>Simultaneous activations</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=200\cdot 200\)</span><br><span class="math inline">\(n_r^0=0.1\)</span><br><span class="math inline">\(n_s^0=0.4\)</span><br><span class="math inline">\(n_p^0=0.5\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(30\)</span><br> <img width="300" src="./results/lattice8_animation.gif"></td>
<td><img width="400" src="./results/lattice8_evolution.png"></td>
</tr>
<tr class="even">
<td>Simultaneous activations</td>
<td><span class="math inline">\(n\_species=4\)</span><br><span class="math inline">\(N=200\cdot 200\)</span><br><span class="math inline">\(n_r^0=0.25\)</span><br><span class="math inline">\(n_s^0=0.25\)</span><br><span class="math inline">\(n_p^0=0.25\)</span><br><span class="math inline">\(n_u^0=0.25\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(200\)</span><br> <img width="300" src="./results/lattice9_animation.gif"></td>
<td><img width="400" src="./results/lattice9_evolution.png"></td>
</tr>
<tr class="odd">
<td>Simultaneous activations</td>
<td><span class="math inline">\(n\_species=5\)</span><br><span class="math inline">\(N=200\cdot 200\)</span><br><span class="math inline">\(n_r^0=0.2\)</span><br><span class="math inline">\(n_s^0=0.2\)</span><br><span class="math inline">\(n_p^0=0.2\)</span><br><span class="math inline">\(n_u^0=0.2\)</span><br><span class="math inline">\(n_v^0=0.2\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(100\)</span><br> <img width="300" src="./results/lattice10_animation.gif"></td>
<td><img width="400" src="./results/lattice10_evolution.png"></td>
</tr>
<tr class="even">
<td>Reichenbach, Mobilia and Frey model</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=150\cdot 150\)</span><br><span class="math inline">\(n_r^0=0.25\)</span><br><span class="math inline">\(n_s^0=0.25\)</span><br><span class="math inline">\(n_p^0=0.25\)</span><br><span class="math inline">\(n_u^0=0.25\)</span><br><span class="math inline">\(swap\_exp=-1\)</span><br><span class="math inline">\(reproduce\_exp=0\)</span><br><span class="math inline">\(select\_exp=0\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(300\)</span><br> <img width="300" src="./results/lattice11_animation.gif"></td>
<td><img width="400" src="./results/lattice11_evolution.png"></td>
</tr>
<tr class="odd">
<td>Reichenbach, Mobilia and Frey model</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=150\cdot 150\)</span><br><span class="math inline">\(n_r^0=0.25\)</span><br><span class="math inline">\(n_s^0=0.25\)</span><br><span class="math inline">\(n_p^0=0.25\)</span><br><span class="math inline">\(n_u^0=0.25\)</span><br><span class="math inline">\(swap\_exp=0\)</span><br><span class="math inline">\(reproduce\_exp=0\)</span><br><span class="math inline">\(select\_exp=0\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(300\)</span><br> <img width="300" src="./results/lattice12_animation.gif"></td>
<td><img width="400" src="./results/lattice12_evolution.png"></td>
</tr>
<tr class="even">
<td>Reichenbach, Mobilia and Frey model</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=150\cdot 150\)</span><br><span class="math inline">\(n_r^0=0.25\)</span><br><span class="math inline">\(n_s^0=0.25\)</span><br><span class="math inline">\(n_p^0=0.25\)</span><br><span class="math inline">\(n_u^0=0.25\)</span><br><span class="math inline">\(swap\_exp=0.5\)</span><br><span class="math inline">\(reproduce\_exp=0\)</span><br><span class="math inline">\(select\_exp=0\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(300\)</span><br> <img width="300" src="./results/lattice13_animation.gif"></td>
<td><img width="400" src="./results/lattice13_evolution.png"></td>
</tr>
<tr class="odd">
<td>Reichenbach, Mobilia and Frey model</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=150\cdot 150\)</span><br><span class="math inline">\(n_r^0=0.25\)</span><br><span class="math inline">\(n_s^0=0.25\)</span><br><span class="math inline">\(n_p^0=0.25\)</span><br><span class="math inline">\(n_u^0=0.25\)</span><br><span class="math inline">\(swap\_exp=1\)</span><br><span class="math inline">\(reproduce\_exp=0\)</span><br><span class="math inline">\(select\_exp=0\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(300\)</span><br> <img width="300" src="./results/lattice14_animation.gif"></td>
<td><img width="400" src="./results/lattice14_evolution.png"></td>
</tr>
<tr class="even">
<td>Reichenbach, Mobilia and Frey model</td>
<td><span class="math inline">\(n\_species=3\)</span><br><span class="math inline">\(N=100\cdot 100\)</span><br><span class="math inline">\(n_r^0=0.25\)</span><br><span class="math inline">\(n_s^0=0.25\)</span><br><span class="math inline">\(n_p^0=0.25\)</span><br><span class="math inline">\(n_u^0=0.25\)</span><br><span class="math inline">\(swap\_exp=1\)</span><br><span class="math inline">\(reproduce\_exp=-0.7\)</span><br><span class="math inline">\(select\_exp=-0.7\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(1000\)</span><br> <img width="300" src="./results/lattice15_animation.gif"></td>
<td><img width="400" src="./results/lattice15_evolution.png"></td>
</tr>
<tr class="odd">
<td>Reichenbach, Mobilia and Frey model</td>
<td><span class="math inline">\(n\_species=4\)</span><br><span class="math inline">\(N=150\cdot 150\)</span><br><span class="math inline">\(n_r^0=0.2\)</span><br><span class="math inline">\(n_s^0=0.2\)</span><br><span class="math inline">\(n_p^0=0.2\)</span><br><span class="math inline">\(n_u^0=0.2\)</span><br><span class="math inline">\(swap\_exp=0\)</span><br><span class="math inline">\(reproduce\_exp=0\)</span><br><span class="math inline">\(select\_exp=0\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(300\)</span><br> <img width="300" src="./results/lattice16_animation.gif"></td>
<td><img width="400" src="./results/lattice16_evolution.png"></td>
</tr>
<tr class="even">
<td>Reichenbach, Mobilia and Frey model</td>
<td><span class="math inline">\(n\_species=5\)</span><br><span class="math inline">\(N=150\cdot 150\)</span><br><span class="math inline">\(n_r^0=0.17\)</span><br><span class="math inline">\(n_s^0=0.17\)</span><br><span class="math inline">\(n_p^0=0.17\)</span><br><span class="math inline">\(n_u^0=0.17\)</span><br><span class="math inline">\(n_v^0=0.17\)</span><br><span class="math inline">\(swap\_exp=0\)</span><br><span class="math inline">\(reproduce\_exp=0\)</span><br><span class="math inline">\(select\_exp=0\)</span></td>
<td style="text-align: center;">Around step <span class="math inline">\(300\)</span><br> <img width="300" src="./results/lattice17_animation.gif"></td>
<td><img width="400" src="./results/lattice17_evolution.png"></td>
</tr>
</tbody>
</table>
</section>
<section id="additional-experiments" class="level2">
<h2 class="anchored" data-anchor-id="additional-experiments">Additional Experiments</h2>
<table class="table">
<colgroup>
<col style="width: 36%">
<col style="width: 63%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Experiment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Discrete time</td>
<td><img width="350" src="./results/weakest_survival.png"></td>
</tr>
<tr class="even">
<td>Continuous time</td>
<td><img width="350" src="./results/orbits.png"></td>
</tr>
<tr class="odd">
<td>Discrete time</td>
<td><img width="350" src="./results/discrete_ternary_evolution.png"></td>
</tr>
<tr class="even">
<td>Lattice model, <br>Frean and Abraham</td>
<td><img width="350" src="./results/lattice_ternary_evolution.png"></td>
</tr>
<tr class="odd">
<td>Lattice model, <br>Frean and Abraham</td>
<td><img width="350" src="./results/lattice_contour.png"></td>
</tr>
</tbody>
</table>
</section>
<section id="stochastic-model-checking" class="level2">
<h2 class="anchored" data-anchor-id="stochastic-model-checking">Stochastic Model Checking</h2>
<table class="table">
<colgroup>
<col style="width: 46%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th>Query</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>P=?[ F r=0 ]</code></td>
<td><span class="math inline">\(0.14\)</span></td>
</tr>
<tr class="even">
<td><code>P=?[ F s=0 ]</code></td>
<td><span class="math inline">\(0.98\)</span></td>
</tr>
<tr class="odd">
<td><code>P=?[ F (MAX-r-s)=0 ]</code></td>
<td><span class="math inline">\(0.87\)</span></td>
</tr>
<tr class="even">
<td><code>P=?[ F (r=70 &amp; (F r=0)) ]</code></td>
<td><span class="math inline">\(0.14\)</span></td>
</tr>
<tr class="odd">
<td><code>P=?[ F (s=70 &amp; (F s=0)) ]</code></td>
<td><span class="math inline">\(0.65\)</span></td>
</tr>
<tr class="even">
<td><code>P=?[ F ((MAX-r-s)=70 &amp; (F (MAX-r-s)=0)) ]</code></td>
<td><span class="math inline">\(0.29\)</span></td>
</tr>
<tr class="odd">
<td><code>P=?[ F (MAX-r-s)=0 &amp; s=0 ]</code></td>
<td><span class="math inline">\(0.12\)</span></td>
</tr>
<tr class="even">
<td><code>P=?[ F s=0 &amp; r=0 ]</code></td>
<td><span class="math inline">\(0.02\)</span></td>
</tr>
<tr class="odd">
<td><code>P=?[ F r=0 &amp; (MAX-r-s)=0 ]</code></td>
<td><span class="math inline">\(0.86\)</span></td>
</tr>
<tr class="even">
<td><code>P=? [ F&lt;time r=0 ]</code><br><code>P=? [ F&lt;time s=0 ]</code><br><code>P=? [ F&lt;time (MAX-r-s)=0 ]</code></td>
<td><img width="400" src="./results/prism_extintion.png"></td>
</tr>
<tr class="odd">
<td><code>P=? [F&lt;time (r=0 | r=MAX | s=0) &amp;</code><br><code>(s=0 | s=MAX | (MAX-r-s)=0) &amp;</code><br><code>((MAX-r-s)=0 | (MAX-r-s)=MAX | r=0)]</code></td>
<td><img width="400" src="./results/prism_absorbing_state.png"></td>
</tr>
<tr class="even">
<td><code>P=? [ F=1 r&gt;=x &amp; r&lt;x+10 ]</code><br><code>P=? [ F=1 s&gt;=x &amp; s&lt;x+10 ]</code><br><code>P=? [ F=1 (MAX-r-s)&gt;=x &amp; (MAX-r-s)&lt;x+10 ]</code></td>
<td><img width="400" src="./results/prism_individuals.png"></td>
</tr>
</tbody>
</table>
</section>
<section id="petri-net-analysis" class="level2">
<h2 class="anchored" data-anchor-id="petri-net-analysis">Petri Net Analysis</h2>
<section id="p--t-invariants-and-siphons" class="level3">
<h3 class="anchored" data-anchor-id="p--t-invariants-and-siphons">P-, T-invariants and Siphons</h3>
<ul>
<li>The Transition Matrix C (where rows are indexed by P, R, S and columns by Pp, Pr, Ps in this order) is <span class="math display">\[C = \begin{bmatrix} 2 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 0 &amp; 2 \end{bmatrix} - \begin{bmatrix} 1 &amp; 0 &amp; 1 \\ 1 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 1 \end{bmatrix}\]</span></li>
<li><span class="math inline">\(x \cdot C = 0 \iff x=[1,1,1]\)</span>, x is a <strong>Place Invariant</strong> (the sum of the number of tokens in the places is equal to <span class="math inline">\(100\)</span>)</li>
<li><span class="math inline">\(C \cdot y = 0 \iff y=[1,1,1]^t\)</span>, y is a <strong>Transition Invariant</strong> (applying the three transitions an equal number of times will not change the marking of the net)</li>
<li><span class="math inline">\(\{P\}, \{R\}, \{S\}\)</span> are <strong>minimal siphons</strong> (once a species goes extinct, it cannot be reintroduced in the system)
<ul>
<li><span class="math inline">\(\bullet \{P\} = \{Pp\} \subseteq \{P\}\bullet =\{Pp, Ps\} \implies \{P\}\)</span> is a siphon</li>
<li><span class="math inline">\(\bullet \{R\} = \{Pr\} \subseteq \{R\}\bullet =\{Pr, Pp\} \implies \{R\}\)</span> is a siphon</li>
<li><span class="math inline">\(\bullet \{S\} = \{Ps\} \subseteq \{S\}\bullet =\{Ps, Pr\} \implies \{S\}\)</span> is a siphon</li>
</ul></li>
</ul>
</section>
<section id="properties" class="level3">
<h3 class="anchored" data-anchor-id="properties">Properties</h3>
<table class="table">
<colgroup>
<col style="width: 34%">
<col style="width: 14%">
<col style="width: 31%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>Abbreviation</th>
<th>Name</th>
<th>Description</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PUR</td>
<td>pure</td>
<td><span class="math inline">\(\forall x, y \in P \cup T : f (x, y) \neq 0 \implies f (y, x) = 0\)</span>, i.e.&nbsp;there are no two nodes, connected in both directions. This precludes read arcs. Then the net structure is fully represented by the incidence matrix, which is used for the calculation of the P- and T-invariants.</td>
<td>❌</td>
</tr>
<tr class="even">
<td>ORD</td>
<td>ordinary</td>
<td><span class="math inline">\(\forall x, y \in P \cup T : f (x, y) \neq 0 \implies f (x, y) = 1\)</span>, i.e.&nbsp;all arc weights are equal to 1. This includes homogeneity. A non-ordinary Petri net cannot be live and 1-bounded at the same time.</td>
<td>❌</td>
</tr>
<tr class="odd">
<td>HOM</td>
<td>homogeneous</td>
<td><span class="math inline">\(\forall p \in P :t,t^{\prime} \in p• \implies f(p,t)=f(p,t^{\prime})\)</span>, i.e.&nbsp;all outgoing arcs of a given place have the same multiplicity.</td>
<td>✅</td>
</tr>
<tr class="even">
<td>NBM</td>
<td>non blocking multiplicity</td>
<td>A net has non-blocking multiplicity if <span class="math inline">\(\forall p \in P :•p \neq \emptyset \land min\{f(t,p)\vert \forall t \in •p\}\geq max\{f(p,t)\vert \forall t \in p•\}\)</span>, i.e.&nbsp;an input place causes blocking multiplicity. Otherwise, it must hold for each place: the minimum of the multiplicities of the incoming arcs is not less than the maximum of the multiplicities of the outgoing arcs.</td>
<td>✅</td>
</tr>
<tr class="odd">
<td>CSV</td>
<td>conservative</td>
<td>A Petri net is conservative if <span class="math inline">\(\forall t \in T : \sum_{p \in •t} f(p,t) = \sum_{p \in t•} f(t,p)\)</span> i.e.&nbsp;all transitions add exactly as many tokens to their postplaces as they subtract from their preplaces, or briefly, all transitions fire token-preservingly. A conservative Petri net is structurally bounded.</td>
<td>✅</td>
</tr>
<tr class="even">
<td>SCF</td>
<td>structurally conflict free</td>
<td>A Petri net is static (or structurally) conflict free if <span class="math inline">\(\forall t,t^{\prime} \in T :t \neq t^{\prime} \implies •t \cap •t^{\prime} = \emptyset\)</span>, i.e.&nbsp;there are no two transitions sharing a preplace. Transitions involved in a static conflict compete for the tokens on shared preplaces. Thus, static conflicts indicate situations where dynamic conflicts, i.e.&nbsp;nondeterministic choices, may occur in the system behaviour. However, it depends on the token situation whether a conflict does actually occur dynamically. There is no nondeterminism in SCF nets.</td>
<td>❌</td>
</tr>
<tr class="odd">
<td>FT0</td>
<td>every transition has a pre-place</td>
<td><span class="math inline">\(\forall t: •t \neq \emptyset\)</span></td>
<td>✅</td>
</tr>
<tr class="even">
<td>TF0</td>
<td>every transition has a post-place</td>
<td><span class="math inline">\(\forall t: t• \neq \emptyset\)</span></td>
<td>✅</td>
</tr>
<tr class="odd">
<td>FP0</td>
<td>every place has a pre-transition</td>
<td><span class="math inline">\(\forall p: •p \neq \emptyset\)</span></td>
<td>✅</td>
</tr>
<tr class="even">
<td>PF0</td>
<td>every place has a post-transition</td>
<td><span class="math inline">\(\forall p: p• \neq \emptyset\)</span></td>
<td>✅</td>
</tr>
<tr class="odd">
<td>CON</td>
<td>connected</td>
<td>A Petri net is connected if it holds for every two nodes <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> that there is an undirected path between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. Disconnected parts of a Petri net cannot influence each other, so they can usually be analyzed separately.</td>
<td>✅</td>
</tr>
<tr class="even">
<td>SC</td>
<td>strongly connected</td>
<td>A Petri net is strongly connected if it holds for every two nodes <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> that there is a directed path from <span class="math inline">\(a\)</span> to <span class="math inline">\(b\)</span>. Strong connectedness involves connectedness and the absence of boundary nodes. It is a necessary condition for a Petri net to be live and bounded at the same time.</td>
<td>✅</td>
</tr>
<tr class="odd">
<td>NC</td>
<td>netclass</td>
<td>The net structure class: 1) A Petri net is called State Machine (SM) if <span class="math inline">\(\forall t\in T :\vert •t \vert =\vert t•\vert \leq 1\)</span>, i.e.&nbsp;there are neither forward branching nor backward branching transitions. 2) A Petri net is called Synchronisation Graph (SG) if <span class="math inline">\(\forall p\in P :\vert •p\vert =\vert p•\vert \leq 1\)</span>, i.e.&nbsp;there are neither forward branching nor backward branching places. 3) A Petri net is called Extended Free Choice (EFC) if <span class="math inline">\(\forall p,q\in P:p• ∩q• =\emptyset \lor p• =q•\)</span>, i.e.&nbsp;transitions in conflict have identical sets of preplaces. 4) A Petri net is called Extended Simple (ES) if <span class="math inline">\(\forall p,q\in P:p• \cap q• =\emptyset \lor p• \subseteq q• \lor q• \subseteq p•\)</span>, i.e.&nbsp;every transition is involved in one conflict at most. 5) If the net does not comply to any of the introduced net structure classes, it is said to be not Extended Simple (nES).</td>
<td>nES</td>
</tr>
<tr class="even">
<td>RKTH</td>
<td>rank theorem</td>
<td><span class="math inline">\(rank(IM) \neq \vert SCCS\vert - 1 \implies !RKTH\)</span>, i.e.&nbsp;if the rank of the incidence matrix is not equal to the number of strongly connected components (maximal sets of strongly connected nodes) minus one, then the rank theorem does not hold.</td>
<td>❌</td>
</tr>
<tr class="odd">
<td>STP</td>
<td>siphon trap property</td>
<td>The siphon trap property holds if no siphons are bad. A siphon is called bad if it does not include a trap.</td>
<td>❌</td>
</tr>
<tr class="even">
<td>CPI</td>
<td>covered by P-invariants</td>
<td>A net is covered by P-invariants, shortly CPI, if every place belongs to a P-invariant.</td>
<td>✅</td>
</tr>
<tr class="odd">
<td>CTI</td>
<td>covered by T-invariants</td>
<td>A net is covered by T-invariants, shortly CTI, if every transition belongs to a T-invariant.</td>
<td>✅</td>
</tr>
<tr class="even">
<td>SCTI</td>
<td>strongly covered by T-invariants</td>
<td>The two transitions modelling the two directions of a reversible reaction always make a minimal T-invariant and they are called trivial T-invariants. A net which is covered by nontrivial T-invariants is said to be strongly covered by T-invariants.</td>
<td>✅</td>
</tr>
<tr class="odd">
<td>SB</td>
<td>structurally bounded</td>
<td>A net is structurally bounded if it is bounded for any initial marking</td>
<td>✅</td>
</tr>
<tr class="even">
<td>k-B</td>
<td>k-bounded</td>
<td>A place <span class="math inline">\(p\)</span> is k-bounded (bounded for short) if there exists a positive integer number <span class="math inline">\(k\)</span>, which represents an upper bound for the number of tokens on this place in all reachable markings of the Petri net: <span class="math inline">\(\exists k \in \mathbb{N}_0 :\forall m\in [m_0⟩:m(p)\leq k\)</span>. A Petri net is k-bounded (bounded for short) if all its places are k-bounded.</td>
<td>100</td>
</tr>
<tr class="odd">
<td>DCF</td>
<td>dynamically conflict free</td>
<td>Dynamic conflict is a behavioral property which refers to a marking enabling two transitions, but the firing of one transition disables the other one. The occurrence of dynamic conflicts causes alternative (branching) system behavior, whereby the decision between these alternatives is taken nondeterministically.</td>
<td>❌</td>
</tr>
<tr class="even">
<td>DSt</td>
<td>no dead state(s)</td>
<td>True if the net does not have dead states (markings).</td>
<td>3</td>
</tr>
<tr class="odd">
<td>DTr</td>
<td>no dead transition(s)</td>
<td>If the net does not have dead transitions at the initial state.</td>
<td>✅</td>
</tr>
<tr class="even">
<td>LIV</td>
<td>live</td>
<td>A Petri net is live (strongly live) if each transition is live.</td>
<td>❌</td>
</tr>
<tr class="odd">
<td>REV</td>
<td>reversible</td>
<td>A Petri net is reversible if the initial marking can be reached again from each reachable marking: <span class="math inline">\(\forall m \in [m_0⟩ : m_0 \in [m⟩\)</span></td>
<td>❌</td>
</tr>
</tbody>
</table>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© 2024 Irene Testa. This project was developed for the “Computational Models for Complex Systems” course at the University of Pisa (a.y. 2023/2024).</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>